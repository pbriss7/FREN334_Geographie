---
title: "GÃ©ographie et cartographie littÃ©raires"
author: "Pascal Brissette"
format:
  html:
    toc: true
    toc-depth: 2
    toc-location: left
    code-fold: true
    code-tools: true
    theme: Yeti
    reference-location: margin
    title-block-banner: true
    self-contained: true
    standalone: true
editor: visual
lang: fr
execute:
  freeze: auto
  echo: true
  warning: false
  message: false
---

```{r}

#| echo: false
#| message: false
#| warning: false

if(!"data.table" %in% rownames(installed.packages())) {install.packages("data.table")}
if(!"sf" %in% rownames(installed.packages())) {install.packages("sf")}
if(!"tidyverse" %in% rownames(installed.packages())) {install.packages("tidyverse")}
if(!"leaflet" %in% rownames(installed.packages())) {install.packages("leaflet")}
if(!"leaflet.providers" %in% rownames(installed.packages())) {install.packages("leaflet.providers")}
if(!"viridis" %in% rownames(installed.packages())) {install.packages("viridis")}
if(!"DT" %in% rownames(installed.packages())) {install.packages("DT")}

library(data.table)
library(sf)
library(leaflet)
library(leaflet.providers)
library(viridis)
library(DT)

```

# I. Qu'est-ce que la gÃ©ographie littÃ©raire?

Ã€ quel point avez-vous prÃªtÃ© attention Ã  la gÃ©ographie imaginaire du dernier roman que vous avez lu? Vous a-t-il semblÃ© que ces lieux jouaient un rÃ´le important, au point que l'histoire n'aurait pu prendre place nulle part ailleurs? Ou, au contraire, les lieux n'Ã©taient-ils qu'un simple dÃ©cor sans rÃ©elle importance dans la fiction? Ces lieux Ã©taient-ils imaginaires et sans lien avec la rÃ©alitÃ©? Ã‰taient-ils rÃ©fÃ©rentiels, portant des noms connus de pays, de villes ou de rÃ©gions historiques? Peut-Ãªtre Ã©taient-ce des lieux qui ont existÃ© autrefois, des villes disparues ou portant aujourd'hui d'autres noms? Peut-Ãªtre encore ces lieux portaient-ils des noms Ã©tranges, inventÃ©s, mais leur description rappelaient des villes ou des rÃ©gions familiÃ¨res? Y avait-il un lien entre le type d'intrigue ou la forme du roman (par exemple: un roman policier), et le type de lieux habitÃ©s et parcourus par les personnages? Vous est-il dÃ©jÃ  arrivÃ© de parcourir un quartier ou une rÃ©gion, et de voir ceux-ci Ã  travers une fiction que vous aviez dÃ©jÃ  lue? Peut-Ãªtre vous Ãªtes-vous dit: Â«c'est ici que tel personnage a vÃ©cu telle Ã©motion, qu'il a fait telle chose, que tel Ã©vÃ©nement s'est produit.Â»

La gÃ©ographie littÃ©raire s'intÃ©resse Ã  ces questions et Ã  bien d'autres. L'expression Â«gÃ©ographie littÃ©raireÂ» renvoie Ã  une famille de travaux et de recherches qui s'intÃ©ressent aux liens entre la littÃ©rature et l'espace.

L'exploration de ces liens peut prendre plusieurs directions.

## La littÃ©rature dans l'espace

La premiÃ¨re est celle d'une exploration entre la littÃ©rature comme activitÃ© sociale et culturelle, et les lieux oÃ¹ elle est Ã©crite, publiÃ©e, Ã©ditÃ©e, traduite, diffusÃ©e, consommÃ©e. Par exemple, on peut s'intÃ©resser Ã  la localisation des maisons d'Ã©dition ou des lieux de rÃ©sidence d'Ã©crivains, ou encore des lieux de rassemblement des associations et groupes littÃ©raires dans le temps. On verrait par exemple que si l'activitÃ© littÃ©raire au QuÃ©bec s'est surtout concentrÃ©e dans la ville de QuÃ©bec au XIXe siÃ¨cle, elle s'est dÃ©placÃ©e vers MontrÃ©al au XXe siÃ¨cle. De tels travaux relÃ¨vent de l'histoire et de la sociologie de la littÃ©rature. Ils s'intÃ©ressent Ã  l'activitÃ© ou Ã  la vie littÃ©raire, Ã  ses divers acteurs et institutions, dans le temps et dans l'espace.

Un exemple de ce type d'approche: le projet Â«Mapping Germain Fiction in TranslationÂ», de Lisa Teichmann, liÃ© Ã  sa thÃ¨se de doctorat. Dans ce projet, L. Teichmann propose une gÃ©olocalisation des traductions d'ouvrages de fiction publiÃ©s initialement par des Ã©crivains allemands.

![](images/clipboard-3818084537.png)

[Geomapping Bibliographic Translation data from the German National Library Catalogue](https://lt-ladirec.shinyapps.io/GeomappingTranslationsPrototype/)

## L'espace dans la littÃ©rature

La deuxiÃ¨me est celle d'une exploration de l'espace *dans* les Å“uvres. Certains critique comme Bakhtine ou Moretti s'intÃ©ressent Ã  l'espace qui se dÃ©ploie dans des sous-groupes d'oeuvres, par exemple le roman grec antique, le roman pastoral ou encore le roman sentimental, et aux lieux typiques mis en scÃ¨ne et parcourus par les personnages. Moretti s'intÃ©resse par exemple aux romans de Jane Austen et montre qu'ils sont ancrÃ©s dans une partie trÃ¨s restreinte de l'Angleterre, une zone sÃ©curitaire oÃ¹ les jeunes femmes peuvent passer d'un lieu Ã  un autre, dans le contexte d'un marchÃ© du mariage. Pour Bakhtine et Moretti, chaque type de roman possÃ¨de ou privilÃ©gie un type d'espace. De nombreux travaux ont Ã©tÃ© menÃ©s, dans cette perspective, sur le roman policier et l'espace urbain, ce type de roman se dÃ©ployant de maniÃ¨re privilÃ©giÃ©e dans les dÃ©dales de la ville, oÃ¹ il est aisÃ© de se cacher et d'Ã©chapper Ã  la police (Rosemberg, 2007). L'idÃ©e de ce type d'approche est de mettre en lien un type d'espace reprÃ©sentÃ© *dans* le roman et autre chose, comme le genre ou sous-genre mÃªme dont relÃ¨ve ce roman.

On peut s'intÃ©resser Ã©galement aux parcours gÃ©ographiques de personnages chez un auteur en particulier ou un groupe d'auteurs (d'une mÃªme Ã©poque, d'un mÃªme courant littÃ©raire, comme le romantisme, le rÃ©alisme, le naturalisme, etc.), ou aux connotations rattachÃ©es par un Ã©crivain aux lieux habitÃ©s ou parcourus par les personnages. Les lieux peuvent Ãªtre ouverts (parc, rue, boulevard) ou fermÃ©s (maison, salon, commerce), privÃ©s ou publics, centraux ou pÃ©riphÃ©riques. Ils peuvent Ãªtre dÃ©crits de l'intÃ©rieur, de la maniÃ¨re dont les voit et perÃ§oit les personnages, ou l'Ãªtre par le narrateur, de maniÃ¨re externe.

## L'usage des cartes

On peut faire de la gÃ©ographie littÃ©raire sans nullement recourir Ã  des cartes gÃ©ographiques! Dans l'ouvrage issu de sa thÃ¨se de doctorat, le gÃ©ographe Marc Brosseau s'est intÃ©ressÃ© aux Â«romans-gÃ©ographesÂ», c'est-Ã -dire Ã  la maniÃ¨re dont les romans construisent, remplissent et habitent les espaces, et Ã  la maniÃ¨re dont ils forment l'Å“il humain. La gÃ©ographie qu'ils crÃ©ent, qui peut emprunter des fragments Ã  la rÃ©alitÃ©, ou non, n'a rien d'un traitÃ© scientifique, mais le savoir spÃ©cial qu'ils possÃ¨dent et fournissent sur les lieux humains est trÃ¨s prÃ©cieux. L'ouvrage issu de sa thÃ¨se explore ainsi plusieurs Å“uvres littÃ©raires pour voir le type de gÃ©ographie qu'ils dÃ©ploient, mais sans jamais recourir Ã  des cartes. La seule carte gÃ©ographique de cet ouvrage se trouve paradoxalement sur la jaquette!

![](images/clipboard-3536775245.png)

La carte peut cependant Ãªtre un outil d'analyse d'un grand intÃ©rÃªt. Elle peut servir Ã  rÃ©vÃ©ler des motifs, des trajectoires, des rÃ©gularitÃ©s ou des aberrations qui n'auraient pas Ã©tÃ© aussi aisÃ©s Ã  saisir sans cet outil. La carte est une autre maniÃ¨re d'observer et de lire des phÃ©nomÃ¨nes sociaux (la distribution gÃ©ographique des maisons d'Ã©dition au QuÃ©bec au XXIe siÃ¨cle, par exemple) ou littÃ©raires (le parcours typique des protagonistes du roman de formation au XIXe siÃ¨cle, par exemple). **La carte peut donc Ãªtre utilisÃ©e aussi bien dans la premiÃ¨re famille d'Ã©tudes Ã©voquÃ©e ci-dessus (Â«la littÃ©rature dans l'espaceÂ») que dans la deuxiÃ¨me (Â«l'espace dans la littÃ©ratureÂ»). Selon l'objectif de la recherche, les hypothÃ¨ses et la mÃ©thode, elle peut Ãªtre, ou non, mobilisÃ©e comme outil heuristique et analytique.**

Toute carte ne repose pas sur un systÃ¨me d'information gÃ©ographique (GIS, pour Geographic Information System), c'est-Ã -dire sur une convention offrant une maniÃ¨re particuliÃ¨re de reprÃ©senter le monde, de le simplifier et de le comprendre. Dans un cours de gÃ©ographie littÃ©raire que je donnais il y a quelque temps, une Ã©tudiante qui venait de la rÃ©gion de Gatineau disait que la carte du mÃ©tro de MontrÃ©al Ã©tait celle qui lui avait le mieux permis de comprendre la gÃ©ographie montrÃ©alaise. Sa reprÃ©sentation mentale de MontrÃ©al et de son espace Ã©tait insÃ©parable de cette carte. Elle ne pensait pas MontrÃ©al en tant que groupe de quartiers ou d'arrondissements; ce n'Ã©taient pas les grandes artÃ¨res et autoroutes qui lui permettaient de circuler ou de se situer gÃ©ographiquement; les lignes de mÃ©tro et les stations Ã©taient ses points de rÃ©fÃ©rence. Une telle carte n'obÃ©it nullement aux conventions cartographiques de Google Maps.

Les Ã©crivaines et Ã©crivains utilisent parfois des cartes pour illustrer l'espace ou le monde oÃ¹ se dÃ©ploient les personnages de leur univers, ou, plus mÃ©taphoriquement, pour illustrer le cheminement sentimental ou intellectuel que doivent effectuer leurs personnages pour rÃ©ussir.

![](images/Gallica_Carte_Tendre.jpg) Source: Mlle de ScudÃ©ry, Â«Carte du TendreÂ», dans *ClÃ©lie. Histoire romaine*. Gallica.

![](images/_89553428_tolkienmap2.png) Source: Tolkiens, Carte de la Terre-du-milieu, annotÃ©e par l'auteur de *Lord of the Ring*. BBC.

La gÃ©ographie littÃ©raire peut ainsi prendre plusieurs directions et s'intÃ©resser Ã  de nombreux phÃ©nomÃ¨nes qui n'ont en commun qu'un intÃ©rÃªt entre l'espace et la littÃ©rature. Cet intÃ©rÃªt peut porter sur des phÃ©nomÃ¨nes historiques ou sociologiques et leur inscription dans la gÃ©ographie mondiale ou nationale (*littÃ©rature dans l'espace*); il peut Ã©galement porter sur un aspect gÃ©ographique intrinsÃ¨que Ã  la fiction, construit Ã  l'intÃ©rieur de la littÃ©rature (*l'espace dans la littÃ©rature*). Quant Ã  la cartographie, elle peut Ãªtre utilisÃ©e, ou non, comme outil d'analyse et de dÃ©couverte dans l'un et l'autre cas, pour faire apparaÃ®tre, rendre visibles des liens ou des phÃ©nomÃ¨nes liÃ©s au sens de l'Å“uvre. De telles cartes peuvent s'appuyer sur les systÃ¨mes d'information gÃ©ographique, comme celui utilisÃ© par Google Maps, sur des cartes historiques, voire des cartes imaginaires et artistiques.

------------------------------------------------------------------------

## Concepts et dÃ©fis de la cartographie : discussion autour du texte de Melanie Conroy

### La mÃ©fiance envers la cartographie littÃ©raire

Dans l'introduction de son ouvrage, Melanie Conroy rappelle que la cartographie a souvent Ã©tÃ© rejetÃ©e par les spÃ©cialistes de la littÃ©rature. MÃªme ceux qui s'intÃ©ressent Ã  la gÃ©ographie littÃ©raire s'en mÃ©fient, car elle est considÃ©rÃ©e comme un geste Â«positivisteÂ». Qu'est-ce qu'elle veut dire par lÃ  et quelles raisons les spÃ©cialistes peuvent-ils avoir de se mÃ©fier de la cartographie?

### Le processus cartographique

Conroy dÃ©crit un processus qui semble assez simple pour crÃ©er une carte littÃ©raire:

1.  Extraire les noms de lieux (toponymes).
2.  Associer ces noms Ã  des lieux rÃ©els via des rÃ©pertoires (gazetteers).
3.  GÃ©olocaliser (trouver les coordonnÃ©es latitude/longitude).
4.  Visualiser sur un fond de carte.

Dans les faits, cependant, ce processus n'est pas aussi aisÃ© et suppose des choix de la part de la ou du cartographe.

Prenons un exemple simple. *La ComÃ©die humaine* s'intÃ©resse beaucoup Ã  Paris. La premiÃ¨re Ã©tape, celle de l'extraction du mot Â«ParisÂ» (ou la Â«capitaleÂ») est facile. La deuxiÃ¨me Ã©tape est moins aisÃ©e. Pourquoi?

La troisiÃ¨me Ã©tape, celle de la gÃ©olocalisation, peut Ã©galement poser quelques difficultÃ©s. Pourquoi? Conroy discute de cette Ã©tape en se rÃ©fÃ©rant Ã  la Â«haussmannisationÂ» de Paris au XIXe siÃ¨cle.

### Des lieux, mais quels lieux?

Si l'on procÃ¨de de maniÃ¨re automatique Ã  l'extraction du mot Â«ParisÂ» dans *La ComÃ©die humaine*, nous obtiendrons une grande quantitÃ© d'occurrences. Cependant, dans le texte, le mot a-t-il toujours la mÃªme valeur et la mÃªme signification? Si je m'intÃ©resse aux dÃ©placements des personnages, le mot Â«ParisÂ» en tant que tel sera plus ou moins pertinent. Pourquoi?

Barbara Piatti, qui a dirigÃ© un ambitieux projet d'Atlas du roman europÃ©en, s'est beaucoup intÃ©ressÃ©e Ã  un autre enjeu de la cartographie littÃ©raire. Elle remarque en effet que les lieux littÃ©raires, contrairement Ã  ceux cartographiÃ©s scientifiquement, ont rarement des frontiÃ¨res claires. Ce sont souvent davantage des zones aux frontiÃ¨res floues que des lieux aux limites nettes. Elle propose une typologie des lieux en cinq points:

1.  `Setting`: un lieu oÃ¹ l'action prend place, occupÃ© par les personnages;
2.  `Zone of action`: plusieurs `settings` formant une zone ou une rÃ©gion (ex.: rÃ©gion de Paris);
3.  `Projected space`: les personnages ne s'y trouvent pas, mais ils s'y rÃ©fÃ¨rent, s'en souviennent, aspirent Ã  y aller, etc.;
4.  `Marker`: lieux mentionnÃ©s, par exemple par la narration, mais agissant davantage comme un point de repÃ¨re dans l'espace que comme un lieu investi Ã©motionnellement;
5.  `Route`: le long desquelles les personnages se dÃ©placent (d'un `setting` Ã  un autre).

## Pour aller plus loin

-   MikhaÃ¯l Bakhtine, *EsthÃ©tique et thÃ©orie du roman*, traduit du russe par Daria Olivier, Paris, Gallimard, 1978 \[1975\].

-   Rachel Bouvet (Ã©d.), *LittÃ©rature et gÃ©ographie*, MontrÃ©al, Presses de l'UniversitÃ© du QuÃ©bec, 2018.

-   Marc Brosseau, *Les romans-gÃ©ographes. Essais*, Paris, L'Harmattan, coll. Â«GÃ©ographie et culturesÂ», 1996.

-   Michel Collot, *Pour une gÃ©ographie littÃ©raire*, Paris, Ã‰ditions Corti, coll. Â«Les essaisÂ», 2014.

-   Melanie Conroy, *Literary Geographies in Balzac and Proust*, Cambridge, Cambridge University Press, coll. Â«Elements in Digital Literary StudiesÂ», 2021.

-   Franco Moretti, *Graphes, cartes et arbres. ModÃ¨les abstraits pour une autre histoire de la littÃ©rature*, traduit de l'anglais par Ã‰tienne Dobenesque, Paris, Les prairies ordinaires, coll. Â«Penser/croiserÂ», 2008.

-   Barbara Piatti, Anne-Kathrin Reuschel, Hans Rudolf BÃ¤r, William Cartwright et Lorenz Hurni, Â«Mapping Literature. Towards a Geography of FictionÂ», dans Cartwright, W. et al. *Cartography and Art*, Wiesbaden, p. 177-192. <https://www.literaturatlas.eu/files/2012/01/Piatti2008_ArtAndCartography_Springer.pdf>

-   Muriel Rosemberg (dir.), *GÃ©ographie et cultures*, Â«Le roman policier. Lieux et itinÃ©rairesÂ», no 61, 2007.

-   Lisa Teichmann, Â«Mapping German fiction in translation in the German National Library catalogue (1980-2020)Â», Department of Language, Literature and Culture, UniversitÃ© McGill, 2023. <https://escholarship.mcgill.ca/concern/theses/0p096d03z?locale=en>

------------------------------------------------------------------------

# II. Atelier de cartographie littÃ©raire â€” Le Paris de *La ComÃ©die humaine*

Pour ce premier atelier, nous allons utiliser les donnÃ©es compilÃ©es de diverses sources par Melanie Conroy dans le cadre de sa recherche sur la gÃ©ographie balzacienne. Chemin faisant, nous allons faire nos premiers pas avec la structure de donnÃ©es la plus utilisÃ©e, le tableau de donnÃ©es.

## Consultation des donnÃ©es dans un logiciel

La premiÃ¨re maniÃ¨re de consulter les donnÃ©es compilÃ©es par Conroy â€” et la plus simple â€”, est de passer par l'interface [`Tableau public`](https://public.tableau.com/app/profile/melanie.conroy/viz/BalzacsParis/BalzacsParis "Mapping Balzac - Tableau"). En cliquant sur le lien prÃ©cÃ©dent, vous pourrez consulter trois graphiques exploitant les donnÃ©es.

1.  Une projection des lieux nommÃ©s sous forme de points: les couleurs sont associÃ©es Ã  des titres d'ouvrages et la taille, au nombre d'occurrences;
2.  Une projection des lieux nommÃ©s dans un diagramme circulaire (tarte), avec les mÃªmes caractÃ©ristiques esthÃ©tiques;
3.  Un diagramme Ã  barres montrant, pour chaque roman, l'importance des quartiers liÃ©s Ã  des mentions de lieux.

**Exercice**:

1.  Sous l'onglet 3 (diagramme Ã  barres), commencez par repÃ©rer le roman *Illusions perdues*. Quel est le quartier le plus important? Avez-vous une idÃ©e de ce qui s'y trouve et s'y passe?
2.  Sous l'onglet 2 (diagramme circulaire), repÃ©rez les lieux clÃ©s du Paris des Å“uvres de Balzac. Quels sont ces lieux et pourquoi sont-ils essentiels Ã  la dynamique de *La ComÃ©die humaine*?

------------------------------------------------------------------------

## Consultation des donnÃ©es brutes

L'interface graphique de Tableau est attrayante, mais elle est limitÃ©e: nous ne pouvons interagir qu'avec les donnÃ©es que l'auteure a souhaitÃ© montrer. Il peut Ãªtre intÃ©ressant de retourner aux donnÃ©es brutes pour plusieurs raisons:

1.  Il est toujours utile et important de regarder l'Ã©tat des donnÃ©es et de la structure. Dans certains cas, on peut rapidement repÃ©rer des problÃ¨mes de cohÃ©rence ou des enjeux d'uniformisation, puis les corriger.
2.  Les donnÃ©es pourraient Ãªtre beaucoup plus riches que ne le laisse croire l'interface Tableau: il est possible que la structure brute contienne des colonnes permettant d'Ã©tendre l'enquÃªte;
3.  MÃªme si les donnÃ©es ne correspondent pas parfaitement Ã  ce que nous cherchons, nous pourrons peut-Ãªtre en extraire quelques Ã©lÃ©ments que nous pourrons ensuite enrichir.

Les donnÃ©es utilisÃ©es pour crÃ©er les graphiques de Tableau ont Ã©tÃ© dÃ©posÃ©es par Melanie Conroy sur son compte Github. Github est un espace de partage et de collaboration permettant aux programmeurs et dÃ©veloppeurs de rendre publics du code et des donnÃ©es.

[`Mapping Balzac -- Github`](https://github.com/mrconroy/mapping-balzac "Mapping Balzac - Github")

Cliquez sur [`MappingBalzac_Paris_Comedie_Humaine.tsv`](https://github.com/mrconroy/mapping-balzac/blob/master/MappingBalzac_Paris_Comedie%20Humaine.tsv "MappingBalzac_Paris_Comedie_Humaine.tsv") pour voir l'Ã©tat des donnÃ©es.

Que remarquez-vous?

## Consultation des donnÃ©es nettoyÃ©es

Un petit coup de balai est essentiel pour rendre ces donnÃ©es exploitables. Entre autres, les caractÃ¨res latins ont Ã©tÃ© systÃ©matiquement corrigÃ©s Ã  l'aide d'un logiciel spÃ©cialisÃ© (OpenRefine).

En cliquant sur la flÃ¨che ![](images/clipboard-3589718497.png){width="20"} du bloc ci-dessous, Posit exÃ©cutera les lignes de commande et vous pourrez visualiser les trois premiÃ¨res lignes de la structure de donnÃ©es.

```{r}
#| label: setup
#| echo: true

# 1. DÃ©finition des noms de colonnes
noms_colonnes <- c(
  "livre", "book", "vol", "series", "series_ch", "start_page", "end_page",
  "region", "type_of_place", "place_raw", "place_raw_paris_france", "quartier",
  "lat", "long", "description", "types_involved", "characters_full_name",
  "characters_csv", "shop_name", "store_type", "historical_figures", "date",
  "wiki_url", "image_url", "discourse"
)

# 2. Importation et nettoyage initial des donnÃ©es
dt <- fread("donnees/MappingBalzacParis_final.csv", quote = "\"", col.names = noms_colonnes)

# Nettoyage des coordonnÃ©es dÃ¨s l'importation.
# On s'assure que lat et long sont des nombres (numeric).
# na.omit() supprime les lignes oÃ¹ les coordonnÃ©es sont manquantes.
dt <- dt[, `:=`(lat = as.numeric(lat), long = as.numeric(long))][!is.na(lat) & !is.na(long)]

# Nettoyage de la variable 'discourse'
dt[is.na(discourse) | !(discourse %in% c("Fact", "Event", "Description")), discourse := "Autre"]

# Ajout d'un identifiant unique pour chaque ligne, utile pour les jointures
dt[, row_id := .I]

# Affichage des premiÃ¨res lignes pour vÃ©rification
datatable(head(dt, 3))
```

Cette structure de donnÃ©es, trÃ¨s commune, est une table plate ou Â«tableau de donnÃ©esÂ» (*data frame* en anglais). Il comporte deux dimensions, avec des lignes et des colonnes. Si vous avez dÃ©jÃ  travaillÃ© avec Excel, vous ne serez pas perturbÃ© outre mesure par cette structure.

**Question**: de quoi sont formÃ©es, ici, les lignes et les colonnes? Il est trÃ¨s important de comprendre cette structure pour pouvoir l'exploiter adÃ©quatement.

**Question**: d'aprÃ¨s vous, est-ce que toutes les colonnes ont Ã©tÃ© exploitÃ©es par Conroy dans l'interface Tableau?

### Partie 1 â€” Exploration des donnÃ©es, une dimension Ã  la fois

Avant d'aller plus loin, faisons une petite pause terminologique.

Quand on travaille avec un tableau de donnÃ©es, il est utile dâ€™avoir un vocabulaire simple et commun pour en parler. Quelques mots-clÃ©s suffisent pour commencer : **population**, **individus**, **variables**, **valeur** et **type de donnÃ©e**.

La **population** correspond Ã  lâ€™ensemble sur lequel porte notre observation. Par exemple, tous les livres ou articles de notre corpus.

On appellera **individus** chaque Ã©lÃ©ment de cette population occupant une ligne du tableau, par exemple chaque livre ou article de notre corpus.

Enfin, on appellera **variables** les caractÃ©ristiques que nous mesurons ou notons pour chaque individu. Le nom de l'auteur, l'annÃ©e de publication, la maison d'Ã©dition, les sujets dont traite chaque ouvrage du tableau.

Au croisement des lignes et des colonnes, donc des individus et des variables, se trouvent les **valeurs**.

Une **valeur**, câ€™est lâ€™information prÃ©cise enregistrÃ©e pour un individu donnÃ© sur une variable donnÃ©e.

â€¢ Exemple : si la variable est Â« Ã¢ge Â», et que lâ€™individu est Alice, la valeur peut Ãªtre Â« 20 Â».

Les **types de donnÃ©es.** Dans un tableau bien fait, toutes les valeurs dâ€™une mÃªme variable doivent Ãªtre du mÃªme type. Câ€™est ce type qui dÃ©termine la nature des informations quâ€™on peut enregistrer et les opÃ©rations possibles.

Les principaux types de donnÃ©es sont : â€¢ chaÃ®nes de caractÃ¨res (strings) : par exemple Â« Paris Â», Â« Nantes Â», Â« AngoulÃªme Â» ; â€¢ nombres entiers (integers) : 1, 2, 3, 4 ; â€¢ nombres dÃ©cimaux (floats) : 1.1, 1.5, 4.5 ; â€¢ boolÃ©ens (booleans) : TRUE ou FALSE (oui/non, prÃ©sent/absent).

ğŸ‘‰ Dans une colonne donnÃ©e, on ne retrouve donc quâ€™un seul type de donnÃ©es, ce qui garantit la cohÃ©rence de la variable et la possibilitÃ© dâ€™effectuer des calculs ou des regroupements pertinents.

Fin de la pause terminologique!

Devant un tableau comportant autant d'individus (4408) et de variables (25), on peut se sentir un peu perdu. Aussi, la premiÃ¨re chose Ã  faire est une exploration univariÃ©e, c'est-Ã -dire un regroupement des valeurs identiques d'une seule variable, question de voir l'importance de chaque groupe.

Dans le bloc suivant, nous allons crÃ©er notre premier regroupement: nous allons d'abord observer les diffÃ©rentes valeurs entrÃ©es par Melanie Conroy pour la variable `discourse`, puis nous allons calculer la frÃ©quence de chacune de ces catÃ©gories.

```{r}

unique(dt$discourse)

```

```{r}
dt[, .N, discourse][order(-N)]
```

Nous pourrions proposer le mÃªme examen pour chacune des variables catÃ©gorielles (c'est-Ã -dire les variables pour lesquelles les valeurs sont des catÃ©gories, gÃ©nÃ©ralement en nombre limitÃ©). Essayez par exemple de remplacer `discourse` par `type_of_place` dans la derniÃ¨re ligne de code, puis exÃ©cutez le bloc.

#### Notre premier diagramme Ã  barres

Avec une table de frÃ©quence comme celle que nous venons de composer, nous pouvons fabriquer un diagramme Ã  barres. Chaque valeur de la variable correspondra Ã  une barre et la hauteur de celle-ci sera dÃ©terminÃ©e par la frÃ©quence (le nombre entier dans la deuxiÃ¨me colonne du tableau).

Le bloc ci-dessous offre une fonction maison permettant de crÃ©er un tel diagramme Ã  barres pour une variable donnÃ©e. Changez par exemple la variable `discourse` par `type_of_place` dans la fonction, puis exÃ©cutez le bloc.

```{r}
#| label: "exploration_categorielle_avancee"
#| fig-cap: "Exploration des variables catÃ©gorielles avec options"
#| warning: false
#| message: false


plot_distribution <- function(data, variable, titre, max = 15, viridis = TRUE) {
  # Filtrage des valeurs vides ou manquantes
  data_filtrÃ©e <- data[get(variable) != "" & !is.na(get(variable))]
  
  # Comptage des occurrences
  freq <- data_filtrÃ©e[, .N, by = variable][order(-N)][1:max]
  noms_ordonnes <- freq[[variable]]
  
  # Sous-ensemble des donnÃ©es
  data_top <- data_filtrÃ©e[get(variable) %in% noms_ordonnes]
  
  # TracÃ©
  p <- ggplot(data_top, aes(x = reorder(get(variable), -table(get(variable))[get(variable)]))) +
    geom_bar(aes(fill = ..count..)) +
    labs(title = titre, x = variable, y = "Nombre de mentions") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none")
  
  # Option de coloration viridis
  if (viridis) {
    p <- p + scale_fill_viridis_c(option = "D", direction = -1, end = 0.9)
  }
  
  return(p)
}

plot_distribution(dt, "discourse", "RÃ©partition des types de lieux")


```

Ã€ nouveau, changez `discourse` par une autre variable, `type_of_place`, puis exÃ©cutez Ã  nouveau le bloc.

### Exploration cartographique

Comme le jeu de donnÃ©es de Melanie Conroy a Ã©tÃ© gÃ©orÃ©fÃ©rencÃ© et que chaque entrÃ©e possÃ¨de une valeur de latitude et une de longitude, il est possible de projeter chaque individu sur une carte sous la forme d'un petit point. Si vous retournez au [`premier onglet de Tableau -- Mapping Balzac`](https://public.tableau.com/app/profile/melanie.conroy/viz/BalzacsParis/BalzacsParis "Mapping Balzac"), vous verrez de ces points.

**Question**: pourquoi certains de ces points sont-ils plus volumineux?

Pour rendre la carte plus lisible, il est souvent souhaitable d'**agrÃ©ger** les points qui occupent la mÃªme position gÃ©ographique. Ainsi, la taille du point sera proportionnelle au nombre de fois que les coordonnÃ©es identiques se trouvent dans le jeu de donnÃ©es.

Une autre maniÃ¨re de simplifier et d'agrÃ©ger les donnÃ©es gÃ©ographiques est de les rassembler Ã  l'intÃ©rieur d'une zone donnÃ©e de la carte, et de colorer la carte en fonction de la densitÃ© des points.

Dans le bloc de code ci-dessous, j'utilise la carte des arrondissements contemporains de Paris ([`donnÃ©es disponibles ici`](https://opendata.paris.fr/explore/dataset/arrondissements/export/?disjunctive.l_ar&disjunctive.c_arinsee&disjunctive.c_ar&location=13,48.85156,2.32327 "Arrondissements de Paris")). Chaque arrondissement est formÃ© de coordonnÃ©es qui forment un polygone. On dÃ©termine combien de points uniques du jeu de donnÃ©es de Conroy Â«tombentÂ» dans chaque polygone, puis on colore chaque polygone en fonction d'une Ã©chelle graduÃ©e. Ce type de carte est appelÃ© **choroplÃ¨the**.

```{r}
#| label: "preparation_carte_choroplethe"
#| message: false
#| warning: false

# --- Ã‰tape 1: PrÃ©paration des objets gÃ©ospatiaux ---

# Chargement du fichier GeoJSON des arrondissements de Paris.
# st_transform(4326) s'assure que le systÃ¨me de coordonnÃ©es est le mÃªme que celui de nos points (WGS84).
arrondissements <- st_read("donnees/arrondissements.geojson", quiet = TRUE) |>
  st_transform(4326)

# Conversion de notre data.table en objet 'sf' (simple features).
# On spÃ©cifie que les colonnes 'long' et 'lat' sont les coordonnÃ©es.
points_sf <- st_as_sf(dt, coords = c("long", "lat"), crs = 4326, remove = FALSE)

# --- Ã‰tape 2: Jointure spatiale ---

# On effectue une jointure spatiale pour savoir dans quel arrondissement se trouve chaque point.
# `st_join` ajoute les colonnes des arrondissements (ex: c_ar, l_ar) aux points situÃ©s Ã  l'intÃ©rieur.
points_avec_arrond <- st_join(points_sf, arrondissements, join = st_within)

# --- Ã‰tape 3: Comptage des mentions par arrondissement ---

# On repasse en data.table pour une agrÃ©gation rapide.
dt_final <- as.data.table(points_avec_arrond)

# On compte le nombre de mentions (N) par arrondissement (`l_ar`).
# On filtre les points qui n'ont pas trouvÃ© d'arrondissement (NA).
comptes_arrond <- dt_final[!is.na(l_ar), .N, by = .(l_ar, c_ar)]
setnames(comptes_arrond, "N", "mentions") # On renomme la colonne pour plus de clartÃ©

# --- Ã‰tape 4: Jointure des comptes au gÃ©o-rÃ©fÃ©rentiel ---

# On joint nos comptes Ã  l'objet spatial 'arrondissements'.
# `merge` est utilisÃ© ici pour la jointure.
arrondissements_avec_comptes <- merge(arrondissements, comptes_arrond, by = c("l_ar", "c_ar"), all.x = TRUE)

# On remplace les NA (arrondissements sans mention) par 0.
arrondissements_avec_comptes$mentions[is.na(arrondissements_avec_comptes$mentions)] <- 0


# --- Ã‰tape 5: CrÃ©ation de la carte interactive Leaflet ---

pal <- colorNumeric(palette = "viridis", domain = arrondissements_avec_comptes$mentions, reverse = TRUE)

carte_choroplethe <- leaflet(arrondissements_avec_comptes) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~pal(mentions),
    weight = 2,
    opacity = 1,
    color = "white",
    dashArray = "3",
    fillOpacity = 0.7,
    popup = ~paste(
      "<strong>Arrondissement :</strong>", l_ar, "<br>",
      "<strong>Nombre de mentions :</strong>", mentions, "<br>",
      "<strong>Pourcentage du total :</strong>",
      round(mentions / sum(mentions, na.rm = TRUE) * 100, 1), "%"
    ),
    highlightOptions = highlightOptions(
      weight = 3, color = "#666", dashArray = "",
      fillOpacity = 0.9, bringToFront = TRUE
    )
  ) %>%
  addLegend(
    pal = pal, values = ~mentions, opacity = 0.7,
    title = "Nombre de<br>mentions", position = "bottomright"
  ) %>%
  setView(lng = 2.34, lat = 48.86, zoom = 11)

carte_choroplethe
```

Le Paris de Balzac est fortement concentrÃ© autour des arrondissements centraux de la rive droite.

# Exploration avancÃ©e: l'analyse bivariÃ©e

Ã€ quel type de question l'analyse univariÃ©e permet-elle de rÃ©pondre?

-   Â«Quels sont les lieux souvent mentionnÃ©s dans les romans de Balzac?Â»

Ce type d'exploration, une donnÃ©e Ã  la fois, Ã  l'aide de diagrammes Ã  barres ou de cartes gÃ©ographiques, permet certes de repÃ©rer des tendances fortes ou faibles, mais il ne permet pas encore de comprendre le lien *entre* les variables.

Pour cela, il faut croiser les valeurs de deux colonnes ou plus, et compter le nombre de fois que des paires de valeurs sont trouvÃ©es.

Supposons par exemple que j'aie crÃ©Ã© un jeu de donnÃ©es dans lequel se trouve dix romans de Balzac (un par ligne) et que j'aie notÃ©, pour chacun, le lieu du dÃ©but du roman (lieu_debut) et le lieu oÃ¹ le roman se termine (lieu_fin).

```{r}

# CrÃ©ation du jeu de donnÃ©es exemple

balzac_romans <- data.frame(
  roman = c("Le PÃ¨re Goriot", "EugÃ©nie Grandet", "La Cousine Bette", 
            "Le Cousin Pons", "CÃ©sar Birotteau", "La Peau de chagrin",
            "Illusions perdues", "Splendeurs et misÃ¨res", "La Femme de trente ans",
            "Le Lys dans la vallÃ©e"),
  lieu_debut = c("Paris", "Saumur", "Paris", "Paris", "Paris", "Paris",
                 "AngoulÃªme", "Paris", "Paris", "Tours"),
  lieu_fin = c("Paris", "Saumur", "Paris", "Paris", "Paris", "Alpes",
               "Paris", "Paris", "Normandie", "Tours"),
  annee_publication = c(1835, 1833, 1846, 1847, 1837, 1831, 1843, 1847, 1842, 1836)
)

# Affichage du tableau
balzac_romans
```

Dans le contexte d'une analyse bivariÃ©e, on posera des questions comme les suivantes:

Â«Y a-t-il une **relation** entre le lieu de dÃ©but et le lieu de fin des romans ?Â» Â«Les romans qui commencent Ã  Paris finissent-ils gÃ©nÃ©ralement Ã  Paris ?Â» Â«Observe-t-on des patterns de mobilitÃ© gÃ©ographique selon l'Ã©poque de publication ?Â»

Pour rÃ©pondre Ã  ce type de question, il faut construire un petit tableau oÃ¹ nous noterons le nombre d'occurrences de chaque paire. C'est ce qu'on appelle un tableau de contingence

```{r}
# Tableau de contingence : lieu_debut Ã— lieu_fin
tableau_cooc <- table(balzac_romans$lieu_debut, balzac_romans$lieu_fin)
print(tableau_cooc)

# Ou avec dplyr pour plus de flexibilitÃ©
contingence <- balzac_romans %>%
  count(lieu_debut, lieu_fin, name = "frequence") %>%
  arrange(desc(frequence))

print(contingence)
```

Les donnÃ©es d'un tableau de contingence peuvent Ãªtre projetÃ©s dans une carte de chaleur:

```{r}

# Heatmap pour visualiser les croisements
ggplot(contingence, aes(x = lieu_debut, y = lieu_fin, fill = frequence)) +
  geom_tile() +
  geom_text(aes(label = frequence), color = "white", size = 4) +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "Carte de chaleur de la mobilitÃ© gÃ©ographique",
       x = "Lieu de dÃ©but", 
       y = "Lieu de fin",
       fill = "FrÃ©quence") +
  theme_minimal()
```

Nous allons maintenant faire cela avec de Â«vraiesÂ» donnÃ©es, cette fois, celles du tableau de Melanie Conroy.

Nous allons, en guise d'exemple, croiser les modalitÃ©s de la variable **sÃ©rie littÃ©raire** (Â«ScÃ¨nes de la vie parisienneÂ», Â«ScÃ¨nes de la vie de provinceÂ», etc.) et celles de la variable **rÃ©gion gÃ©ographique** pour vÃ©rifier que Balzac situe bien en province les Â«ScÃ¨nes de la vie de provinceÂ»!

Les noms de variables Ã  utiliser ici sont `series_ch` pour la sÃ©rie littÃ©raire et `region` pour la rÃ©gion gÃ©ographique.

```{r}
#| label: "preparation_heatmap"
#| warning: false
#| message: false


# Nettoyage des valeurs vides
dt_filtrÃ© <- dt[series_ch != "" & !is.na(series_ch) & region != "" & !is.na(region)]

# CrÃ©ation de la matrice de cooccurrences
matrice_cooc <- dcast(
  dt_filtrÃ©[, .N, by = .(series_ch, region)],
  series_ch ~ region,
  value.var = "N",
  fill = 0
)

# AperÃ§u des donnÃ©es agrÃ©gÃ©es
head(matrice_cooc)
```

Le bloc suivant, quant Ã  lui, crÃ©e la carte de chaleur et rend visible les croisements de donnÃ©es.

```{r}
#| label: "plot_heatmap_simple"
#| fig-cap: "Carte de chaleur simplifiÃ©e"
#| warning: false
#| message: false

# Fonction simplifiÃ©e pour tracer une carte de chaleur Ã  partir d'une matrice
plot_heatmap <- function(matrice, titre = "Carte de chaleur") {
  
  # Conversion en format long
  data_long <- melt(matrice, id.vars = colnames(matrice)[1], variable.name = "colonne", value.name = "N")
  
  ggplot(data_long, aes_string(x = "colonne", y = colnames(matrice)[1], fill = "N")) +
    geom_tile(color = "white") +
    scale_fill_viridis_c(option = "C", direction = -1) +
    labs(title = titre, x = "Variable 2", y = "Variable 1", fill = "FrÃ©quence") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

plot_heatmap(matrice_cooc, "Carte de chaleur : sÃ©ries Ã— rÃ©gions")

```

On n'est pas surpris de voir que les *ScÃ¨nes de la vie parisienne* sont **fortement corrÃ©lÃ©es** avec la CitÃ© et les Boulevards, oÃ¹ l'on trouve les thÃ©Ã¢tres et les divertissements, mais il est plus surprenant de voir que les *ScÃ¨nes de la vie de province* contiennent Ã©galement un nombre Ã©levÃ© de rÃ©fÃ©rences aux mÃªmes Boulevards. Avez-vous une hypothÃ¨se pour expliquer ce phÃ©nomÃ¨ne?

Nous pouvons isoler, dans table initiale, les romans des *ScÃ¨nes de la vie de province* et voir lesquels font le plus souvent rÃ©fÃ©rence aux Boulevards.

```{r}

dt_pie <- dt[series_ch == "ScÃ¨nes de la vie de province" & region == "The Boulevards",
             .N, by = "livre"][order(-N)]
dt_pie
dt_pie |>
  ggplot(aes(x = "", y = N, fill = reorder(livre, -N))) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  geom_text(aes(label = N),   # <- ajouter les Ã©tiquettes
            position = position_stack(vjust = 0.5),  # centre
            color = "white",                         # couleur contrastÃ©e
            size = 4) +                               # taille ajustable
  coord_polar("y", start = 0) +
  theme_void()


```

Ainsi, *Illusions perdues* est le titre des *ScÃ¨nes de la vie de province* qui se rÃ©fÃ¨re le plus Ã  Paris et, comme on sait, toute la partie centrale du roman, Â«Un grand homme de province Ã  ParisÂ», s'y dÃ©roule.
